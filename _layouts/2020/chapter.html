---
# Layout Rewrite 2020: Chapter Layout
layout: compress
---
<!DOCTYPE html>
<html lang="{{ page.lang }}">

<head>
  {% include 2020/1-head/common.html %}
  {% include 2020/1-head/social-chapter.html %}
  {% include 2020/1-head/extra-chapter.html %}
  {% include 2020/1-head/noscript.html %}

<body id="body" class="dark-theme">
  {% include 2020/2-body/common.html %}
  <header aria-flowto="content" id="mobile-top">
    {% include 2020/2-body/header.html %}
  </header>

  <ol class="breadcrumb" aria-label="breadcrumb">
    {% include 2020/2-body/1-breadcrumbs/chapter.html %}
  </ol>

  <nav class="collapse" id="navbar-toggable">
    {% include 2020/2-body/navigation.html %}
  </nav>

  <main id="content" class="chapter">
    <header>
      {% include 2020/2-body/2-main/structured-data-chapter.html %}
      {% include 2020/2-body/2-main/header-chapter.html %}
      {% assign words = content | markdownify | strip_html | split: " " | size %}
      <nav class="d-flex w-100 clearfix">
        {% include 2020/2-body/2-main/navigation-chapter.html %}
      </nav>
    </header>
    <div class="row tts-controls align-items-center no-gutters pb-2">
    {% if page.audio %}
      <div class="col-6 col-md-auto mr-md-2">This chapter as audio:</div>
      <audio controls class="col-6 col-md" aria-describedby="chapter-content">
        {% for mirror in page.book.audio_mirror %}
        {% capture mp4-42 %}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.42.m4a' | replace: 'amauga/', mirror }}" type="audio/mp4; codecs=mp4a.40.42">
        <source src="{{ page.path | replace: '.md', '.42.m4a' | replace: 'amauga/', mirror }}" type="audio/mp4; codecs=mp4a.40.42">
        {% endcapture %}
        {% capture mp4-2 %}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.2.m4a' | replace: 'amauga/', mirror }}" type="audio/mp4; codecs=mp4a.40.2">
        <source src="{{ page.path | replace: '.md', '.2.m4a' | replace: 'amauga/', mirror }}" type="audio/mp4; codecs=mp4a.40.2">
        {% endcapture %}
        {% capture aac %}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.aac' | replace: 'amauga/', mirror }}" type="audio/aac">
        <source src="{{ page.path | replace: '.md', '.aac' | replace: 'amauga/', mirror }}" type="audio/aac">
        {% endcapture %}
        {% capture mp3 %}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.mp3' | replace: 'amauga/', mirror }}" type="audio/mpeg">
        <source src="{{ page.path | replace: '.md', '.mp3' | replace: 'amauga/', mirror }}" type="audio/mpeg">
        {% endcapture %}
        {% assign mp4-42_ms = aac_ms | append: mp4-42 %}
        {% assign mp4-2_ms = mp4_ms | append: mp4-2 %}
        {% assign aac_ms = aac_ms | append: aac %}
        {% assign mp3_ms = mp3_ms | append: mp3 %}
        {% endfor %}
        {{ mp4-42_ms }}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.42.m4a' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mp4; codecs=mp4a.40.42">
        <source src="{{ page.path | replace: '.md', '.42.m4a' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mp4; codecs=mp4a.40.42">
        {{ aac_ms }}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.aac' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/aac">
        <source src="{{ page.path | replace: '.md', '.aac' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/aac">
        {{ mp4-2_ms }}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.2.m4a' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mp4; codecs=mp4a.40.2">
        <source src="{{ page.path | replace: '.md', '.2.m4a' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mp4; codecs=mp4a.40.2">
        {{ mp3_ms }}
        <link rel="alternate" href="{{ page.path | replace: '.md', '.mp3' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mpeg">
        <source src="{{ page.path | replace: '.md', '.mp3' | prepend: '/' | prepend: site.static_url | absolute_url }}" type="audio/mpeg">
      </audio>
    {% endif %}
      <div class="col-4 col-md-auto mx-md-2">Text to Speech:</div>
      <div class="col-8 col-md{% if page.audio %}-2{% endif %} mt-2 mt-md-0">
      <input id="tts" aria-label="Toggle Text-to-Speech" type="checkbox" data-toggle="toggle" data-off="⏸&#xFE0E;&ensp;&nbsp;" data-on="&ensp;&nbsp;▶️&#xFE0E;"
      data-onstyle="green" data-offstyle="red" data-size="lg" data-width="100%">
      </div>
    </div>
    {% if jekyll.environment != "unpublished" %}
    <section class="hyphenate" property="text" aria-flowto="navigation" id="chapter-content">
    {% else %}
    <section property="text" aria-flowto="navigation" id="chapter-content" contenteditable="true">
    {% endif %}
      <!--sse-->
      {% include linkify content=content %}
      <!--/sse-->
    </section>
    <footer>
      {% if words > 300 %}
      <nav class="d-flex w-100 clearfix" id="navigation" aria-flowto="comments">
        {% include 2020/2-body/2-main/navigation-chapter.html %}
      </nav>
      <hr>
      {% endif %}
      <aside class="social">
        {% include 2020/2-body/2-main/sharing-chapter.html %}
      </aside>
    </footer>
  </main>

  <footer>
    <div id="support">
      {% include 2020/3-footer/support.html %}
    </div>
    <div id="copyright" class="float-right">
      {% include 2020/3-footer/copyright.html %}
    </div>
  </footer>

  <div class="policy-banner" id="policy-banner" data-nosnippet>
    {% include 2020/policy-banner.html %}
  </div>
  
  <div class="controls buttons" data-nosnippet>
    {% include 2020/2-body/controls.html %}
  </div>

  {% if page.comments %}
    {% include 2020/2-body/comments.html %}
  {% endif %}

  <!-- hash: 'sha256-jt0fluv+2kfDRP7lqettjyHx8MocFVb7Knqy4uxo7Ps=' -->
  <script>window['pageType']='chapter'</script>
